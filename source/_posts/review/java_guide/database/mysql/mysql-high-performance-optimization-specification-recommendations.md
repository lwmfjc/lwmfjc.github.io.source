---
title: MySQL高性能优化规范建议总结
description: MySQL高性能优化规范建议总结
categories:
  - 学习
tags:
  - 复习
  - 复习-javaGuide
  - 复习-javaGuide-database
date: 2023-01-20 11:36:34
updated: 2023-01-23 09:24:34
---

> 转载自https://github.com/Snailclimb/JavaGuide（添加小部分笔记）感谢作者!

# 数据库命名规范

- 所有**数据库对象**名称必须使用**小写字母**并用**下划线分割**
- 所有数据库对象名称**禁止使用 MySQL 保留关键字**（如果表名中包含关键字查询时，需要将其用单引号括起来）
- 数据库对象的命名要能做到**见名识意**，并且最好**不要超过 32 个**字符
- **临时库表**必须**以 `tmp_` 为前缀**并以日期为后缀，**备份表**必须**以 `bak_` 为前缀**并**以日期 (时间戳) 为后缀**
- 所有**存储相同数据的列名和列类型**必须一致（**一般作为关联列**，如果查询时关联列**类型不一致会自动进行数据类型隐式转换**，会**造成列上的索引失效**，导致查询效率降低）

# 数据库基本设计规范

## 所有表必须使用InnoDB存储引擎

- 没有特殊要求（即 InnoDB 无法满足的功能如：列存储，存储空间数据等）的情况下，所有表必须使用 InnoDB 存储引擎（MySQL5.5 之前默认使用 Myisam，5.6 以后默认的为 InnoDB）。
- InnoDB 支持**事务**，支持**行级锁**，更好的**恢复性**，**高并发**下性能更好

## 数据库和表的字符集统一使用UTF-8

## 所有表和字段都需要添加注释

## 尽量控制单表数据量的大小，建议控制在500万以内

## 谨慎使用MySQL分区表

## 经常一起使用的列放到一个表中

## 禁止在表中建立预留字段

## 禁止在数据库中存储文本（比如图片）这类大的二进制数据

## 不要被数据库范式所束缚

## 禁止在线上做数据库压力测试

## 禁止从开发环境、测试环境，直接连接生产环境数据库



# 数据库字段设计规范

## 优先选择符合存储需要的最小数据类型

## 避免使用TEXT、BLOB数据类型，最常见的TEXT类型可以存储64k的数据

## 避免使用ENUM类型

## 尽可能把所有的列定义为NOT NULL

## 使用TIMESTAMP(4个字节)或DATETIME类型（8个字节）存储时间

## 同财务相关的金额类数据必须使用decimal类型

## 单表不要包含过多字段

# 索引设计规范

## 限制每张表上的索引数量，建议单张表索引不超过5个

## 禁止使用全文索引

## 禁止给表中的每一列都建立单独的索引

## 每个InnoDB表必须有个主键

## 常见索引列建议

## 如何选择索引列的顺序

## 避免建立冗余索引和重复索引（增加了查询优化器生成执行计划的时间）

## 对于频繁的查询有优先考虑使用覆盖索引

## 索引SET规范



# 数据库SQL开发规范

## 优化对性能影响较大的SQL语句

## 充分利用表上已经存在的索引

## 禁止使用SELECT * 必须使用SELECT <字段列表> 查询

## 禁止使用不含字段列表的INSERT语句

## 建议使用预编译语句进行数据库操作

## 避免数据类型的隐式转换

## 避免使用子查询，可以把子查询优化为join操作

## 避免JOIN关联太多的表

## 减少同数据库的交互次数

## 对应同一列进行or判断时，使用in代替or

## 禁止使用order by rand() 进行随机排序

## WHERE从句中禁止对列进行函数转换和计算

## 在明显不会有重复值时使用UNION ALL 而不是 UNION

## 拆分复杂的大SQL为多个小SQL

## 程序连接不同的数据库使用不同的账号，禁止跨库查询



# 数据库操作行为规范

##  超 100 万行的批量写 (UPDATE,DELETE,INSERT) 操作,要分批多次进行操作

##  对于大表使用 pt-online-schema-change 修改表结构

## 禁止为程序使用的账号赋予 super 权限

 

## 对于程序连接数据库账号,遵循权限最小原则

 