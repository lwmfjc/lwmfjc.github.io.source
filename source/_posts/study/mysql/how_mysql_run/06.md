---
title: 06B+树索引
description: 06B+树索引
tags:
  - MySQL是怎样运行的
categories:
  - 学习
date: 2023-04-22 15:04:46
updated: 2023-04-22 15:04:46
---

> 学习《MySQL是怎样运行的》，感谢作者！

# 概述

数据页由**7个**组成部分，各个数据页可以组成一个**双向链表**，每个数据页中的记录会按照**主键值从小到大的顺序**组成一个**单向链表**。每个数据页都会为**它里面的记录**生成一个**页目录**，在通过主键查找某条记录的时候可以在**页目录**中使用二分法快速定位到**对应的槽**，然后再**遍历该槽**对应**分组中的记录**即可快速找到**指定**的记录。**页和记录**的关系    

> 页a，页b 可以**不在物理结构上相连**，只要通过**双向链表相关联**即可

![image-20230422205909858](https://raw.githubusercontent.com/lwmfjc/lwmfjc.github.io.resource/main/img/image-20230422205909858.png)

# 没有索引时进行查找

假设我们要搜索**某个列**等于**某个常数**的情况：  
```SELECT [查询列表] FROM 表名 WHERE 列名 = xxx```

## 在一个页中查找

假设记录极少，所有记录可以**存放到一个页中**  

- 以**主键**位搜索条件：页目录中使用**二分法**快速定位到对应的**槽**，然后在**遍历槽对应分组中的记录**，即可快速找到指定记录
- 其他列作为搜索条件：对于**非主键**，数据页没有为**非主键列**建立所谓的**页目录**，所以**无法通过二分法**快速定位相应的槽。只能**从Infimum依次遍历**单向链表中的每条记录，然后对比，效率极低

## 在很多页中查找

两个步骤：  

- **定位到记录所在的页**
- 从**所在页内**查找相应的记录

**没有索引**情况下，不能快速定位到所在页，只能从**第一页**沿着**双向链表**一直往下找，而如果是主键，每一页则可以在**页目录**二分查找。  
不过由于要**遍历所有页**，所以超级**耗时**

# 索引

```shell
#例子
mysql> CREATE TABLE index_demo(
    -> c1 INT,
    -> c2 INT,
    -> c3 CHAR(1),
    -> PRIMARY KEY(c1)
    -> ) ROW_FORMAT=COMPACT;
```

